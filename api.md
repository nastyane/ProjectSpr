## HTTP API для системы управления проектами

Ниже представлен HTTP API для описанной системы управления проектами. При возникновении вопросов или в случае обнаружения ошибок можно писать мне в личные сообщения ВКонтакте.

**Примечания:**
- Код тестов предполагает, что API доступен по адресу `http://localhost:8080/api/vXXX`, где XXX - это версия API и тестов
- Предполагается, что при авторизации пользователь получает токен, который необходимо передавать в заголовке `Authorization`.
- На данный момент API не предусматривает обработку ошибок, это будет добавлено в следующей версии
---

### Пользовательские операции

1. **Регистрация пользователя**

    - **Метод:** `POST`
    - **URL:** `/users/register`
    - **Тело запроса:**
      ```json
      {
        "username": "string",
        "password": "string",
        "email": "string"
      }
      ```
    - **Ответ:**
        - **Код 201 Created** при успешной регистрации.
        - **Код 400 BAD REQUEST** если такой пользователь уже существует.

2. **Авторизация пользователя**

    - **Метод:** `POST`
    - **URL:** `/users/login`
    - **Тело запроса:**
      ```json
      {
        "username": "string",
        "password": "string"
      }
      ```
    - **Ответ:**
      ```json
      {
        "token": "string" // Этот токен необходимо передавать в заголовке Authorization
      }
      ```
      - **Код 200 OK** при получении корректных данных.
      - **Код 401 UNAUTHORIZED** при получении ошибочных данных.

3. **Просмотр проектов пользователя**

    - **Метод:** `GET`
    - **URL:** `/users/{userId}/projects`
    - **Ответ:**
      ```json
      [
        {
          "projectId": "string",
          "projectName": "string",
          "role": "string"
        }
      ]
      ```
       - **Код 200 OK** в случае совпадения userId и текущего пользователя.
       - **Код 403 FORBIDDEN** при отсутствии доступа у пользователя (можно просматривать только свои проекты).

4. **Просмотр заданий пользователя**

    - **Метод:** `GET`
    - **URL:** `/users/{userId}/tickets`
    - **Ответ:**
      ```json
      [
        {
          "ticketId": "string",
          "title": "string",
          "status": "string"
        }
      ]
      ```
      - **Код 200 OK** в случае совпадения userId и текущего пользователя.
      - **Код 403 FORBIDDEN** при отсутствии доступа у пользователя (можно просматривать только свои задачи).

5. **Просмотр сообщений об ошибках для исправления**

    - **Метод:** `GET`
    - **URL:** `/users/{userId}/bugreports`
    - **Ответ:**
      ```json
      [
        {
          "bugReportId": "string",
          "description": "string",
          "status": "string"
        }
      ]
      ```
      - **Код 200 OK** в случае совпадения userId и текущего пользователя.
      - **Код 403 FORBIDDEN** при отсутствии доступа у пользователя (можно просматривать только назначенные на себя сообщения об ошибках).

6. **Создание нового проекта**

    - **Метод:** `POST`
    - **URL:** `/projects`
    - **Тело запроса:**
      ```json
      {
        "projectName": "string",
        "description": "string"
      }
      ```
    - **Ответ:**
        - **Код 201 Created** с информацией о проекте.
        - **Код 400 BAD REQUEST** такой проект уже существует.

---

### Функции менеджера проекта

1. **Назначение тимлидера**

    - **Метод:** `POST`
    - **URL:** `/projects/{projectId}/teamleader`
    - **Тело запроса:**
      ```json
      {
        "userId": "string"
      }
      ```
    - **Ответ:**
        - **Код 200 OK** при успешном назначении.
        - **Код 403 FORBIDDEN** при отсутствии прав у пользователя.
        - **Код 404 NOT FOUND** если проект не существует.

2. **Добавление разработчика к проекту**

    - **Метод:** `POST`
    - **URL:** `/projects/{projectId}/developers`
    - **Тело запроса:**
      ```json
      {
        "userId": "string"
      }
      ```
    - **Ответ:**
        - **Код 200 OK** при успешном добавлении.
        - **Код 403 FORBIDDEN** при отсутствии прав у пользователя.
        - **Код 404 NOT FOUND** если проект не существует.
        - **Код 400 BAD REQUEST** если пользователь не существует или он уже разработчик.

3. **Добавление тестировщика к проекту**

    - **Метод:** `POST`
    - **URL:** `/projects/{projectId}/testers`
    - **Тело запроса:**
      ```json
      {
        "userId": "string"
      }
      ```
    - **Ответ:**
       - **Код 200 OK** при успешном добавлении.
       - **Код 403 FORBIDDEN** при отсутствии прав у пользователя.
       - **Код 404 NOT FOUND** если проект не существует.
       - **Код 400 BAD REQUEST** если пользователь не существует или он уже тестировщик.

---

### Управление майлстоунами

1. **Создание нового майлстоуна**

    - **Метод:** `POST`
    - **URL:** `/projects/{projectId}/milestones`
    - **Тело запроса:**
      ```json
      {
        "name": "string",
        "startDate": "date",
        "endDate": "date"
      }
      ```
    - **Ответ:**
        - **Код 201 Created** с информацией о майлстоуне
        - **Код 403 FORBIDDEN** при отсутствии прав у пользователя.
        - **Код 404 NOT FOUND** если проект не существует.
        - **Код 400 BAD REQUEST** если такой майлстоун уже существует.

2. **Изменение статуса майлстоуна**

    - **Метод:** `PUT`
    - **URL:** `/milestones/{milestoneId}/status`
    - **Тело запроса:**
      ```json
      {
        "status": "open | active | closed"
      }
      ```
    - **Ответ:**
        - **Код 200 OK** при успешном обновлении.
        - **Код 403 FORBIDDEN** при отсутствии прав у пользователя.
        - **Код 404 NOT FOUND** если такой майлстоун не существует.
        - **Код 400 BAD REQUEST** если статус не является корректным.

---

### Управление тикетами

1. **Создание нового тикета**

    - **Метод:** `POST`
    - **URL:** `/milestones/{milestoneId}/tickets`
    - **Тело запроса:**
      ```json
      {
        "title": "string",
        "description": "string"
      }
      ```
    - **Ответ:**
        - **Код 201 Created** с информацией о тикете.
        - **Код 403 FORBIDDEN** при отсутствии доступа у пользователя.
        - **Код 404 NOT FOUND** при получении несуществующего майлстоуна.
        - **Код 400 BAD REQUEST** если такая задача уже существует.

2. **Привязка разработчика к тикету**

    - **Метод:** `POST`
    - **URL:** `/tickets/{ticketId}/assign`
    - **Тело запроса:**
      ```json
      {
        "userId": "string"
      }
      ```
    - **Ответ:**
        - **Код 200 OK** при успешном назначении.
        - **Код 403 FORBIDDEN** при отсутствии доступа у пользователя.
        - **Код 404 NOT FOUND** при получении несуществующей задачи.
        - **Код 400 BAD REQUEST** если такого пользователя не существует.

3. **Проверка выполнения тикета**

    - **Метод:** `GET`
    - **URL:** `/tickets/{ticketId}/status`
    - **Ответ:**
      ```json
      {
        "status": "new | accepted | in_progress | completed"
      }
      ```
      - **Код 200 OK** при успешном получении.
      - **Код 403 FORBIDDEN** при отсутствии доступа у пользователя.
      - **Код 404 NOT FOUND** при получении несуществующей задачи.
---

### Функции разработчика и тимлидера

1. **Выполнение тикета (обновление статуса)**

    - **Метод:** `PUT`
    - **URL:** `/tickets/{ticketId}/status`
    - **Тело запроса:**
      ```json
      {
        "status": "accepted | in_progress | completed"
      }
      ```
    - **Ответ:**
        - **Код 200 OK** при успешном обновлении.
        - **Код 403 FORBIDDEN** при отсутствии доступа у пользователя.
        - **Код 404 NOT FOUND** при получении несуществующей задачи.
        - **Код 400 BAD REQUEST** если статус не является корректным.

### Функции разработчика и тестировщика

1. **Создание сообщения об ошибке**

    - **Метод:** `POST`
    - **URL:** `/projects/{projectId}/bugreports`
    - **Тело запроса:**
      ```json
      {
        "description": "string"
      }
      ```
    - **Ответ:**
        - **Код 201 Created** с информацией о сообщении об ошибке.
        - **Код 403 FORBIDDEN** при отсутствии доступа у пользователя.
        - **Код 404 NOT FOUND** при получении несуществующего проекта

### Функции разработчика

1. **Исправление сообщения об ошибке**

    - **Метод:** `PUT`
    - **URL:** `/bugreports/{bugReportId}/status`
    - **Тело запроса:**
      ```json
      {
        "status": "fixed"
      }
      ```
    - **Ответ:**
        - **Код 200 OK** при успешном обновлении.
        - **Код 403 FORBIDDEN** при отсутствии доступа у пользователя.
        - **Код 404 NOT FOUND** при получении несуществующего сообщения об ошибке.
        - **Код 400 BAD REQUEST** если статус не является корректным.

---

### Функции тестировщика

1. **Тестирование проекта**

    - **Метод:** `POST`
    - **URL:** `/projects/{projectId}/test`
    - **Ответ:**
        - **Код 200 OK** при успешном тестировании.
        - **Код 403 FORBIDDEN** при отсутствии доступа у пользователя.
        - **Код 404 NOT FOUND** при получении несуществующего проекта.

2. **Проверка исправления сообщения об ошибке**

    - **Метод:** `PUT`
    - **URL:** `/bugreports/{bugReportId}/status`
    - **Тело запроса:**
      ```json
      {
        "status": "tested | closed"
      }
      ```
    - **Ответ:**
        - **Код 200 OK** при успешном обновлении.
        - **Код 403 FORBIDDEN** при отсутствии доступа у пользователя или ошибке перевода статуса.
        - **Код 404 NOT FOUND** при получении несуществующего сообщения об ошибке.
        - **Код 400 BAD REQUEST** если статус не является корректным.